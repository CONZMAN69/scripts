-- =============================================
-- Teleport 
-- =============================================

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- Local Player
local LocalPlayer = Players.LocalPlayer

-- =============================================
--               GUI CREATION
-- =============================================

-- Create the main ScreenGui
local UtilityGui = Instance.new("ScreenGui")
UtilityGui.Name = "UtilityGui"
UtilityGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
UtilityGui.ResetOnSpawn = false

-- Create the main frame
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = UtilityGui
MainFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
MainFrame.BorderColor3 = Color3.fromRGB(85, 85, 125)
MainFrame.BorderSizePixel = 2
MainFrame.Position = UDim2.new(0.1, 0, 0.2, 0)
MainFrame.Size = UDim2.new(0, 250, 0, 300)

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 8)
UICorner.Parent = MainFrame

-- Title Label
local TitleLabel = Instance.new("TextLabel")
TitleLabel.Name = "TitleLabel"
TitleLabel.Parent = MainFrame
TitleLabel.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
TitleLabel.BorderColor3 = Color3.fromRGB(85, 85, 125)
TitleLabel.Size = UDim2.new(1, 0, 0, 35)
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.Text = "Dandy's Hub Tp"
TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleLabel.TextSize = 18

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 8)
TitleCorner.Parent = TitleLabel

-- Status Label for Teleporter
local StatusLabel = Instance.new("TextLabel")
StatusLabel.Name = "StatusLabel"
StatusLabel.Parent = MainFrame
StatusLabel.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
StatusLabel.Position = UDim2.new(0.05, 0, 0.15, 0)
StatusLabel.Size = UDim2.new(0.9, 0, 0, 30)
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.Text = "No location saved"
StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
StatusLabel.TextSize = 14
local StatusCorner = Instance.new("UICorner", StatusLabel)
StatusCorner.CornerRadius = UDim.new(0, 4)

-- Save Location Button
local SaveButton = Instance.new("TextButton")
SaveButton.Name = "SaveButton"
SaveButton.Parent = MainFrame
SaveButton.BackgroundColor3 = Color3.fromRGB(85, 85, 125)
SaveButton.Position = UDim2.new(0.05, 0, 0.3, 0)
SaveButton.Size = UDim2.new(0.9, 0, 0, 30)
SaveButton.Font = Enum.Font.GothamBold
SaveButton.Text = "Save Location"
SaveButton.TextColor3 = Color3.fromRGB(255, 255, 255)
SaveButton.TextSize = 16
local SaveCorner = Instance.new("UICorner", SaveButton)
SaveCorner.CornerRadius = UDim.new(0, 4)

-- Start Teleport Button
local StartButton = Instance.new("TextButton")
StartButton.Name = "StartButton"
StartButton.Parent = MainFrame
StartButton.BackgroundColor3 = Color3.fromRGB(60, 140, 70)
StartButton.Position = UDim2.new(0.05, 0, 0.42, 0)
StartButton.Size = UDim2.new(0.44, 0, 0, 30)
StartButton.Font = Enum.Font.GothamBold
StartButton.Text = "Start TP"
StartButton.TextColor3 = Color3.fromRGB(255, 255, 255)
StartButton.TextSize = 16
local StartCorner = Instance.new("UICorner", StartButton)
StartCorner.CornerRadius = UDim.new(0, 4)

-- Stop Teleport Button
local StopButton = Instance.new("TextButton")
StopButton.Name = "StopButton"
StopButton.Parent = MainFrame
StopButton.BackgroundColor3 = Color3.fromRGB(180, 60, 60)
StopButton.Position = UDim2.new(0.51, 0, 0.42, 0)
StopButton.Size = UDim2.new(0.44, 0, 0, 30)
StopButton.Font = Enum.Font.GothamBold
StopButton.Text = "Stop TP"
StopButton.TextColor3 = Color3.fromRGB(255, 255, 255)
StopButton.TextSize = 16
local StopCorner = Instance.new("UICorner", StopButton)
StopCorner.CornerRadius = UDim.new(0, 4)

-- Divider
local Divider = Instance.new("Frame")
Divider.Parent = MainFrame
Divider.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
Divider.BorderSizePixel = 0
Divider.Position = UDim2.new(0.05, 0, 0.58, 0)
Divider.Size = UDim2.new(0.9, 0, 0, 2)



-- =============================================
--               SCRIPT LOGIC
-- =============================================

-- Variables
local savedPosition = nil
local isTeleporting = false

-- Make the GUI draggable
local dragging = false
local dragStart
local startPos

MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
    end
end)

MainFrame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = false
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Function for Save Button
SaveButton.MouseButton1Click:Connect(function()
    local character = LocalPlayer.Character
    if character and character:FindFirstChild("HumanoidRootPart") then
        savedPosition = character.HumanoidRootPart.Position
        StatusLabel.Text = string.format("Saved: %.1f, %.1f, %.1f", savedPosition.X, savedPosition.Y, savedPosition.Z)
        StatusLabel.TextColor3 = Color3.fromRGB(150, 255, 150) -- Green text for success
    else
        StatusLabel.Text = "Character not found!"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 150, 150) -- Red text for error
    end
end)

-- Function for Start Button
StartButton.MouseButton1Click:Connect(function()
    if savedPosition then
        isTeleporting = true
        StatusLabel.Text = "Teleporting..."
        StatusLabel.TextColor3 = Color3.fromRGB(255, 180, 100) -- Orange text for active
    else
        StatusLabel.Text = "No location saved!"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 150, 150)
    end
end)

-- Function for Stop Button
StopButton.MouseButton1Click:Connect(function()
    isTeleporting = false
    StatusLabel.Text = "Teleport stopped."
    StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
end)

-- Function for Aimbot Button
AimbotButton.MouseButton1Click:Connect(function()
    local nearestPlayer, minDistance = nil, math.huge
    local localCharacter = LocalPlayer.Character
    if not localCharacter or not localCharacter:FindFirstChild("HumanoidRootPart") then return end
    
    local localPos = localCharacter.HumanoidRootPart.Position

    -- Find the nearest player
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") and player.Character:FindFirstChildOfClass("Humanoid").Health > 0 then
            local targetPos = player.Character.HumanoidRootPart.Position
            local distance = (localPos - targetPos).Magnitude
            if distance < minDistance then
                minDistance = distance
                nearestPlayer = player
            end
        end
    end

    -- Aim and fire if a target was found
    if nearestPlayer then
        local targetCharacter = nearestPlayer.Character
        local targetRoot = targetCharacter.HumanoidRootPart
        
        -- Aim the camera at the target
        local camera = workspace.CurrentCamera
        camera.CFrame = CFrame.new(camera.CFrame.Position, targetRoot.Position)
        
        -- Activate the currently held tool
        local tool = localCharacter:FindFirstChildOfClass("Tool")
        if tool then
            tool:Activate()
        end
    end
end)


-- Main loop for the teleport spam
RunService.Heartbeat:Connect(function()
    if isTeleporting and savedPosition then
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            -- Use CFrame for a more reliable teleport that also resets orientation
            character.HumanoidRootPart.CFrame = CFrame.new(savedPosition)
        end
    end
end)
